$(function(){$('input[name="promo"]').hide();$('p[name="promo-show"]').click(function(){$('input[name="promo"]').show('slow');$('p[name="promo-show"]').hide('slow');});$.widget("custom.iconselectmenu",$.ui.selectmenu,{_renderItem:function(ul,item){var li=$("<li>"),wrapper=$("<div>",{text:item.label});if(item.disabled){li.addClass("ui-state-disabled");}
$(".ui-selectmenu-text").css(item.element.attr("data-style"));$("<span>",{style:item.element.attr("data-style"),"class":"ui-icon "+item.element.attr("data-class")}).appendTo(wrapper);return li.append(wrapper).appendTo(ul);},_renderButtonItem:function(item){var buttonItem=$("<span>",{style:item.element.attr("data-style"),"class":"ui-selectmenu-text "+item.element.attr("data-class")})
this._setText(buttonItem,item.label);buttonItem.css("background-repeat","no-repeat");buttonItem.css("background-size","16px 16px");buttonItem.css("padding-left","1.8em");return buttonItem;}});$("#plat").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons avatar");$("#plat22").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons avatar");});$(function(){$('body').on('click','[data-modal="item-model"]',function(e){e.preventDefault();var that=$(this);var item=that.closest('.item-id');var modal=$('.modal[data-id="item-model"]');modal.find('input[name="d-id"]').val(item.attr('data-id'));modal.find('.modal-header').html(item.find('.item-title').html());}).on('click','[data-modal="item-shop-model"]',function(e){e.preventDefault();var that=$(this);var tab=that.closest('.tabs').closest('.tab-id');var item=that.closest('.item-id');var modal=$('.modal[data-id="item-shop-model"]');var price=item.find('input[name="price"]').val();var first=item.find('input[name="first"]').val();modal.find('input[name="id"]').val(item.attr('data-id'));modal.find('input[name="amount"]').val(1);modal.find('input[name="first"]').val(first);modal.find('input[name="server"]').val(tab.attr('id'));modal.find('input[name="price"]').val(price);modal.find('.modal-header').html('Покупка предмета «'+item.find('.item-title').html()+'»');modal.find('[type="submit"]').html('Купить');modal.find('input[name="amount"]').trigger('input');}).on('input','.modal[data-id="item-shop-model"] input[name="amount"]',function(){var that=$(this);var modal=that.closest('.modal');var amount=modal.find('input[name="amount"]').val();var first=modal.find('input[name="first"]').val();amount=parseInt(amount);if(isNaN(amount)||amount<=0){amount=1;}
if(isNaN(first)||first<=0){first=1;}
var price=modal.find('input[name="price"]').val();modal.find('[type="submit"]').html('Купить  '+Math.round((amount*first).toFixed(2))+'шт. за '+Math.round((amount*price).toFixed(2))+'Р');}).on('click','.slide-to-shop',function(e){e.preventDefault();$('html, body').animate({scrollTop:$("#shop").offset().top},1000,'easeOutQuint');});});